<ng-container *ngIf="place$ | async as place">
  <div class="m-1 m-md-4 ">
    <div class="row gap-4 mx-0 place-detail-container mobile-place-detail-container">
    <div class="place-title-container container col-12 py-3 text-darker-bg-theme rounded-top-3">
      <div class="row gap-2 align-items-start ">

        <!-- item, place name-->
        <div class="col-7 col-md-9">
          <div class="col-12 my-1">
                <span class="place-name-text d-flex align-items-center fw-bolder "><span
                  class=""><svg xmlns="http://www.w3.org/2000/svg" height="28px" viewBox="0 -960 960 960" width="28px" fill="currentColor"><path d="M280-80v-366q-51-14-85.5-56T160-600v-280h80v280h40v-280h80v280h40v-280h80v280q0 56-34.5 98T360-446v366h-80Zm400 0v-320H560v-280q0-83 58.5-141.5T760-880v800h-80Z"/>
                </svg></span>{{ place.name }}</span>
          </div>

          <div class="col-12 my-1">
                <span class="place-suburb-text">
                  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="currentColor"><path d="M480-480q33 0 56.5-23.5T560-560q0-33-23.5-56.5T480-640q-33 0-56.5 23.5T400-560q0 33 23.5 56.5T480-480Zm0 294q122-112 181-203.5T720-552q0-109-69.5-178.5T480-800q-101 0-170.5 69.5T240-552q0 71 59 162.5T480-186Zm0 106Q319-217 239.5-334.5T160-552q0-150 96.5-239T480-880q127 0 223.5 89T800-552q0 100-79.5 217.5T480-80Zm0-480Z"/></svg>
                  {{ place.address?.suburb }}
                </span>

          </div>
          <!--          <div class="row my-1"><span class="item-suburb-text  fs-6 text-secondary-emphasis"><i-->
          <!--            class="bi bi-geo-alt fs-5 me-3"></i>{{ item.address?.suburb }}</span></div>-->
        </div>
        <!-- item overall rating-->
        <div class="place-rating-container d-flex flex-column col-5 row gap-1 px-0">
          <div class="ambience-container mobile-ambience-container col-12">
            <div class="d-flex justify-content-between align-items-baseline">
                  <span class="ambience-text me-2">Ambience: </span
                  ><span class=""
            ><span class="fs-6 fw-bold">{{ place.ambience | number: '1.1-1' }}&nbsp;/</span
            ><span class="fw-normal">&nbsp;5</span></span
            >
            </div>
          </div>
          <div class="service-container mobile-service-container col-12">
            <div class="d-flex justify-content-between align-items-baseline">
              <span class="service-text small">Service: </span>
              <span class=""
              ><span
                class="fs-6 fw-bold">{{ place.service | number: '1.1-1' }}&nbsp;/</span
              ><span class="fw-normal">&nbsp;5</span></span
              >
            </div>
            <!--                                    <div class="d-flex justify-content-between mt-auto"><span-->
            <!--                                            class="item-price-text fs-5">Price: </span><span-->
            <!--                                            class="fw-bold fs-5 ms-1">${{item.price}}</span></div>-->
          </div>
          <small class="no-of-reviews-text col-12 fw-normal  fs-smaller"
          >(Out of {{ place.noOfReviews }} reviews)</small
          >
        </div>
      </div>
    </div>

    <div class="col-12">
      <div class="card border-secondary">
        <div class="row mx-0">
          <div class="col-12 col-lg-7 image-container px-0">
            <!-- <div class="card-body d-lg-none d-flex justify-content-between">
               <div class="d-flex flex-column align-items-start align-content-start ">
                        <span class="card-text text-body-secondary text-truncate-3"><i
                                class="bi bi-shop fs-5 me-2"></i>{{item.name}}</span>
                    <span class="card-text text-body-secondary text-truncate-3"><i
                            class="bi bi-geo-alt fs-5 me-2"></i>{{item.address?.suburb}}</span>
                </div>
                <div class="item-rating-container d-flex flex-column fw-bold ">
                    <div class="d-flex justify-content-between"><span
                            class="ambience-text me-2">Ambience: </span><span>{{item.ambience| number : '1.1-1'}}</span>
                    </div>
                    <div class="d-flex justify-content-between"><span class="service-text">Service: </span>
                        <span>{{item.service| number : '1.1-1'}}</span></div>
                </div>
            </div>-->
            <!--                        <ngb-carousel [showNavigationArrows]="config.carousel.showNavigationArrows"-->
            <!--                                      [showNavigationIndicators]="config.carousel.showNavigationIndicators"-->
            <!--                                      [pauseOnHover]="config.carousel.pauseOnHover"-->
            <!--                                      [pauseOnFocus]="config.carousel.pauseOnFocus"-->
            <!--                                      [interval]="0"-->
            <!--                                      #reviewImgCarousel>-->
            <!--                                <ng-container *ngFor="let media of item?.medias;">-->
            <!--                                    <ng-template ngbSlide>-->
            <!--                                        <div class="picsum-img-wrapper">-->
            <img
              [src]="config.bucketAccessEndpoint+'/'+place.medias?.[0]?.key"
              alt="loading picture of the item"
              class="place-detail-img detail-img w-100 img-fluid rounded-0" />
            <!--                                        </div>-->
            <!--                                    </ng-template>-->
            <!--                                </ng-container>-->
            <!--                        </ngb-carousel>-->
          </div>
          <div class="d-flex justify-content-center col-12 col-lg detail-container">
            <div class="row gap-2 mx-0 px-0 my-4 justify-content-center">
              <!--
                <div class="col-12 d-none d-lg-flex row gap-1 flex-column ">
                    <div class="row my-1"><span class="item-name-text fs-6 fw-bolder text-secondary-emphasis"><i
                            class="bi bi-shop fw-bolder fs-4
                                 me-2"></i>{{item.name}}</span></div>
                    <div class="row my-1"><span class="item-suburb-text fw-bolder text-secondary-emphasis"><i
                            class="bi bi-geo-alt fs-4 me-2"></i>{{item.address?.suburb}}</span></div>
                </div>
              -->
              @if(place.tags?.length) {
                <div class="row mx-3 mx-lg-0">
                  <div class="d-flex col-12 col-md-4 col-lg-6 py-1 py-lg-0 text-secondary"
                       *ngFor="let tag of place.tags">
                  <span class="material-symbols-outlined d-inline">
                    {{ getMaterialIconNameForTag({ name: tag.label }) }}
                  </span>
                    <span class="px-2 place-tag-text text-justify d-inline">{{ tag.label }}</span>
                  </div>
                </div>
              }
              <div class="row mx-3 mx-lg-0">
                <div class="opening-times-container row mx-0 px-0">
                  <!-- div Button triggers BusinessHours modal -->
                  <div
                    type="button"
                    class="d-flex flex-row col-12 py-1 py-lg-0 text-secondary"
                    data-bs-toggle="modal"
                    data-bs-target="#businessHoursModal">
                    <span class="fw-bolder d-inline">
                      Business Hours
                      <span class="px-1 text-dark"><i class="bi bi-chevron-right"></i></span>
                    </span>
                  </div>
                  <!--                                <div class="d-flex col-12 col-md-4 col-lg-6 py-1 py-lg-0 text-secondary " *ngFor="let e of Object.entries(item.openingTimes)" >-->
                  <!--                                    <span class=" d-inline">-->
                  <!--                                        {{e[0] | titlecase}}: {{e[1].open  }}:00-{{e[1].close}}:00-->
                  <!--                                    </span>-->
                  <!--                                </div>-->
                </div>
              </div>

              <div
                class="row gap-1 col-12 d-none d-lg-flex place-rating-container desktop-place-rating-container mt-2 fw-bold">
                <!--                              ambience-->
                <div class="d-flex flex-column j">
                  <span class="ambience-text">Ambience: </span>
                  <div class="d-flex flex-row align-items-center justify-content-between progress-container">
                    <div
                      class="progress rounded-0 flex-grow-1 h-100 me-1"
                      role="progressbar"
                      [attr.aria-label]="'Ambience at this place is rated at ' + (place.ambience | number: '1.1')"
                      aria-valuemin="0"
                      aria-valuemax="100">
                      <div class="progress-bar" [style]="'width: ' + place.ambience * 20 + '%'"></div>
                    </div>
                    <span class="ms-1 card-text text-body-secondary text-dark fw-bolder">{{
                      place.ambience | number: '1.1-1'
                    }}</span>
                  </div>
                  <span class="no-of-reviews-text fw-normal text-secondary"
                    >(Out of {{ place.noOfReviews }} reviews):
                  </span>
                  <!--                                    <span>{{item.ambience| number : '1.1-1'}}</span>-->
                </div>
                <!--                              service -->
                <div class="d-flex flex-column">
                  <span class="service-text">Service: </span>
                  <div class="d-flex flex-row align-items-center justify-content-between progress-container">
                    <div
                      class="progress rounded-0 flex-grow-1 h-100 me-1"
                      role="progressbar"
                      [attr.aria-label]="'Service at this place is rated at ' + (place.service | number: '1.1')"
                      aria-valuemin="0"
                      aria-valuemax="100">
                      <div class="progress-bar" [style]="'width: ' + place.service * 20 + '%'"></div>
                    </div>
                    <span class="ms-1 card-text text-body-secondary text-dark fw-bolder">{{
                      place.service | number: '1.1-1'
                    }}</span>
                  </div>
                  <span class="no-of-reviews-text fw-normal text-secondary"
                    >(Out of {{ place.noOfReviews }} reviews):
                  </span>

                  <!--                                    <span>{{item.service| number : '1.1-1'}}</span>-->
                </div>
              </div>
              <div class="row place-give-review-container mt-auto mx-3 mx-lg-0">
                <!--                      <div class="d-flexx justify-content-centerr ">-->
                <button (click)="onGiveAReviewClick()" class="btn btn-dark">
                  {{ config.giveAReviewLabel }}
                </button>
                <!--                      </div>-->
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="place-navigation-container col-12">
      <ul class="nav nav-tabs nav-justified">
        <li class="nav-item cursor-pointer">
          <a
            class="nav-link"
            aria-current="page"
            [ngClass]="{ active: this.showMenuItems, 'fw-bolder': this.showMenuItems }"
            (click)="this.showMenuItems = true">
            <span class="fs-5">Menu Items</span>
          </a>
        </li>
        <li class="nav-item cursor-pointer">
          <a
            class="nav-link"
            aria-current="page"
            [ngClass]="{ active: !this.showMenuItems, 'fw-bolder': !this.showMenuItems }"
            (click)="this.showMenuItems = false">
            <span class="fs-5">Reviews</span>
          </a>
        </li>
      </ul>
    </div>
    <div class="col-12">
      <!-- <router-outlet name="placeSpot"></router-outlet>-->
      <ng-container *ngIf="showMenuItems">
        <app-item-list></app-item-list>
      </ng-container>
      <ng-container *ngIf="!showMenuItems">
        <app-place-reviews [place]="place"></app-place-reviews>
      </ng-container>
    </div>
  </div>
  </div>
  <!-- Modal -->
  <div
    class="modal fade"
    id="businessHoursModal"
    tabindex="-1"
    aria-labelledby="businessHoursModalLabel"
    aria-hidden="true">
    <div class="modal-dialog modal-sm modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h1 class="modal-title fs-5" id="businessHoursModalLabel">Business Hours</h1>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div class="container-fluid">
            <div class="row my-1" *ngFor="let e of Object.entries(place.openingTimes)">
              {{JSON.stringify(e)}}
              <div class="col-4">{{ e[0] | titlecase }}:</div>
              <div class="col-7 ms-auto">{{ e[1].open }}:00 - {{ e[1].close }}:00</div>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>
</ng-container>
